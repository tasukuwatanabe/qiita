---
title: Keeper Commander CLIを使ってチーム開発用の環境変数を安全に共有しよう
tags:
  - 'keeper'
  - 'セキュリティ'
private: true
updated_at: ''
id: null
organization_url_name: null
slide: false
ignorePublish: false
---

## はじめに

こんにちは。HRBrainでオウンドメディア・ランディングページの開発を担当している渡邉です。

チーム開発では、APIキーやデータベースの接続情報といった機密性の高い情報を、**安全に共有する方法**が重要な課題となります。これらの情報を誤って平文で共有したり、バージョン管理システムにコミットしてしまうと、セキュリティリスクを引き起こします。

今回は、この課題に対して、パスワード管理ツール「**Keeper**」のCLIツールである **Keeper Commander CLI** を使って、**チーム開発での環境変数を安全に管理・共有**する方法を紹介します。

Keeperは強力な暗号化機能とアクセス制御機能を提供し、機密情報を安全に保管・共有できるツールです。

[Keeperの公式ドキュメントはこちら](https://docs.keeper.io/jp)

## 環境変数をKeeperに保存する方法

### カスタムフィールドを使用

Keeperでは、環境変数を簡単に管理できます。まず、**カスタムフィールド**に環境変数名とその値をペアで保存します。これにより、各プロジェクトで必要な環境変数を安全に一元管理できるようになります。

カスタムフィールドを使うことで、環境変数を柔軟に検索・取得することが可能となり、.envファイルの管理が不要になります。

## Keeper Commander CLIのインストール手順

Keeper Commander CLIは、Pythonパッケージとして簡単にインストール可能です。以下のコマンドを使ってインストールします。

```bash
pip install keeper-commander
```

### jqコマンドのインストール

環境変数を整形して出力するために、JSON形式のデータを処理できる **jqコマンド** が必要です。jqコマンドがインストールされていない場合、以下の手順でインストールしてください。

- macOS: 
```bash
brew install jq
```

詳細なインストールガイドは以下を参照してください。
- [Keeper Commander CLI公式ドキュメント](https://docs.keeper.io/jp/v/secrets-manager-jp/commander-cli/commander-installation-setup)
- [jq公式ダウンロードページ](https://jqlang.github.io/jq/download/)

## 「ログイン状態を保持」をオンに設定

Keeper Commander CLIで毎回ログイン情報を入力するのは面倒です。そこで、KeeperのWebサイトで「**ログイン状態を保持**」をオンに設定し、スムーズな操作を可能にします。

### 設定手順
1. KeeperのWebサイトにログイン
2. 右上のアカウントアイコンをクリックし、「設定」を選択
3. 「セキュリティ」タブをクリック
4. 「ログイン状態を保持」をオンに設定

## 環境変数を取得する方法

Keeperに保存した環境変数を取得するために、以下のコマンドを実行します。

```bash
keeper get [UID] --format json | jq -r '.custom[] | .label + "=" + .value[]'
```

### コマンドの詳細

- **keeper get [UID]**: Keeperに保存された指定のレコードを取得します。UIDは各レコードに割り当てられた一意の識別子です。
- **--format json**: 出力をJSON形式で整形します。
- **jq -r**: JSONデータを処理し、`label=value` 形式で出力します。

このコマンドを使うことで、必要な環境変数をすぐに取得し、セットアップが簡単になります。

### 実行例

例えば、以下のような環境変数が設定されている場合：

```json
{
  "custom": [
    {
      "label": "API_KEY",
      "value": ["abcd1234"]
    },
    {
      "label": "DB_PASSWORD",
      "value": ["secretpassword"]
    }
  ]
}
```

このコマンドを実行すると、以下のような形式で出力されます。

```
API_KEY=abcd1234
DB_PASSWORD=secretpassword
```

これにより、.envファイルの形式と同様に、環境変数を簡単に設定できます。

## 検索にかかるように環境変数を保存する方法

環境変数をKeeperに保存する方法として、2つのアプローチを考えました。

1. **.envファイルをそのままKeeperにアップロードする方法**
   - ファイル自体をKeeperに保存することは可能ですが、ファイル内の情報は検索対象外となります。

2. **カスタムフィールドを利用する方法**
   - 環境変数を**カスタムフィールド**として保存することで、Keeperの検索機能を活用して必要な情報を迅速に取得可能です。

そのため、検索の利便性を重視し、**カスタムフィールドに環境変数を保存する方法**を採用しました。

## まとめ

Keeperを活用することで、チーム開発における**機密情報の安全な共有**が実現します。特に、CLIツールとjqコマンドを組み合わせることで、**環境変数を効率的かつ安全に管理**できるため、セキュリティリスクを大幅に低減可能です。

今回紹介した方法を活用して、より安全で効率的な開発環境を整えてみてください。

## PR

HRBrainでは積極的にエンジニア採用を行なっているので、ぜひ！

https://www.hrbrain.co.jp/recruit
